Make(webapp)
Add(MainForm,1,35,203)
{
  Left=56
  Top=56
  Width=#3:357|
  Height=#3:413|
  Caption=#12:Mine sweeper|
  link(onCreate,135:doWork2,[])
}
Add(PaintBox,101,126,301)
{
  Left=14
  Top=49
  Width=#3:320|
  Height=#3:320|
  Point(onContextMenu)
  link(onDraw,515:doDraw,[])
}
Add(PaintBox,2,322,168)
{
  Left=14
  Top=49
  Width=#3:320|
  Height=#3:320|
  Point(doVisible)
  Point(onMouseDown)
  Point(onContextMenu)
  link(onDraw,302:doEnum,[])
  link(onMouseDown,537:doOpen,[])
}
Add(Image,18,203,168)
{
  Left=63
  Top=378
  Width=#3:160|
  Height=#2:32|
  Visible=0
  URL=#1998:data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAgCAYAAACVf3P1AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AMCEAEaz2ZoMgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAUxSURBVHja7ZtvbFNVHIafdsMR2AirDJvhtMKMDAy0AxUFVD6YGNNbMJkJDgYDIkuIH8pg2cfxgW3+gQ4jNsYFmcWQIJXhbRWCJjMqCJE/2WCCZsoYZEU6Bo4pdOtaP9SWbcB27y20Ts6TLGvP8p57evLud857dqZrbW0Nk0RMJpMOwX1LKkBTU5Mm8fHjxykuLo5LL7i/0YspEPxvDSjZbEg2m5hlQeINKIwnSJoBhfkESTWgR5bFzAqSuwQLEwqSHkI8sow45BMkzYACQdIMaLPZsP0bRmwilAgSacDbGU6YUJAQAw5lNGFCwWBS73aHski/AhFCBCOqAsZ7K0XcahFoRbdhw4awmAZBUitgfn6+JvGMGTOoq6sTeqHXrNdrTbQCQUJCiNvtFrMkSJwB3W43gUAAt9uNwWDA6/UOaBMI7voesD+SJLFmzRr8fn+szeVysW/fPpxOZ0IG9aZNGvB+q+xRpX/3+5tbh7SUsRgzcnnBVMxDGVMU9xG90xgCeseO5ZrJxK+LF3N55kzFfXz25UU+3esDQK61qPoMW26z/bGrOGM1HvQxZU8rGRe6GXW9DwCP/LIi7atv337rVV+u/PmNjY24XC7a2toAyMnJoaioCIvFMrQBPR4Pfr+fcDiMTnfzLovf78fj8VBQUHDPDRg13GAjKqVsfmSiQqE+fuv8ib2nq/ji9FusfrpWcR+x62TBIBOPHuWZqirSN23i6x07FOmPnfyTr771xz0Xdg0H+4/sb2Om82daFpk4UjGL4LgHVOn7G+3cpVZKt9vJy5mmqo/Nmzdz9epVampqCIfDlJaW4nA42DFo/vSDl1+v1xs5n9HdepHK6/UOuGTwn99f6FNITYlMfk9fQFMfulAIfV+kgnRPmqRI0/7HDbZ83EZ5iSnuz/B+QQHOwkK81dVc6+hQpJlc3wpA1gk/L61sYG7Zj6Sfu6bp+bXffESIEEufL1Kly8rKivko6iWj0XjnJThqKoPBMGTHy5YtS0gVvBv84j+E98wmAOY+uli1vv+/FvxtMHBq9WpFuqoPfud1m5G83Iy4K19vIMCx+noO79zJ9e5uXqusHFY7xn8dgOZVeejC8GzFUczvNfGDY66qMRw6c5Dm86fInzyLqQ/nqVuFysqoqKjAbrcDkJ2dzfr16+8cQmRZRpZlrFbrHTu1Wq0jxnyNvgPIZ94hRJAXTSuxZL+iug+PLOPdvZtj69YxprOT2dXVinRtvgAf7ryA7Y0TN4+0+r1Ww6i0NPIXLgTgUkuLIs2NzEjVvzw9k44nMwFIv/CXquf2BHuoa9gOwJL5S1WPu7KyEp/PR01NDQ6Hg/b2djZu3Dh8CpYkKVY+B5dUSZJGhPmOnP+cAy1bgRALHlvFUzmLNPcVTkkhOHq0Ko1ca4l99W/TQrC3l6b9+yNVZOpURRrfvMhS92DzFSacugJA57RMdfvAI3vwd11izhPPMdk4RfW4u7q6blmCo23DhhCn04nH44ntB61WK5IkJSyEDA4f0fdK0/B3rZ/EXjec3UbD2W0DwomqFKzX05OezsXZszldVJSwX6L+KXjM+PHkLVjA/BUrlG09Ch9H3xPC4mgkpSdM+5yJnCxRHiI6ujrYc9iNDh2F85ZoGv/atWtxuVyUl5cDkJuby/Lly4c3YNRg0e8ul+uWtkSlYK2oMdqwKThOtFY+exzPD6Wl0lwyneaS6Zr0E8ZNYNe6+M58zWYzZrN5+KA41A9Hyn5PMHIZ9k9x4oKp4F6SCpFbCfEg9EKvlX8APorrnD4qXdoAAAAASUVORK5CYII=|
  link(onLoad,105:doWork2,[])
}
Add(DrawImageRegion,23,672,266)
{
  SourceWidth=16
  SourceHeight=16
  Point(doSourceX)
  link(Canvas,2:Canvas,[(678,230)(328,230)])
  link(Image,108:Var3,[(692,217)])
}
Add(MathParse,25,609,308)
{
  MathStr=#5:%1*16|
  DataCount=1
  Args=#2:X1|
  link(onResult,23:doSourceX,[(657,314)(657,279)])
}
Add(GetDataEx,66,161,133)
{
  Angle=1
  link(Data,107:Var1,[])
}
Add(Matrix,97,448,91)
{
  Width=20
  Height=20
}
Add(Matrix,98,378,98)
{
  Width=20
  Height=20
}
Add(Hub,100,91,203)
{
  OutCount=3
  link(onEvent1,495:doSetup,[])
  link(onEvent2,501:doCalk,[(129,216)(129,265)])
  link(onEvent3,101:doDraw,[(115,223)(115,307)])
}
Add(HubEx,105,252,168)
{
  link(onEvent,140:doWork2,[])
}
Add(GetDataEx,107,378,133)
{
  link(Data,98:Array,[])
}
Add(GetDataEx,108,203,210)
{
  link(Data,18:Image,[])
}
Add(GetDataEx,109,161,238)
{
  link(Data,66:Var2,[])
}
Add(Hub,134,210,91)
{
  OutCount=4
  link(onEvent1,444:doEvent1,[])
  link(onEvent2,135:doWork1,[(235,104)(235,81)(81,81)])
  link(onEvent3,139:doWork2,[])
  link(onEvent4,105:doWork1,[(256,118)])
}
Add(HubEx,135,77,203)
{
  link(onEvent,100:doEvent1,[])
}
Add(ChannelToIndex,139,266,98)
{
  link(onIndex,2:doVisible,[(310,104)(310,181)])
}
Add(HubEx,140,294,168)
{
  link(onEvent,2:doDraw,[])
}
Add(AudioPlayer,143,560,77)
{
  Left=371
  Top=238
  Visible=0
  URL=#41:/example/webapp/Game/Minesweeper/bomb.ogg|
}
Add(Hub,144,448,63)
{
  link(onEvent1,139:doWork1,[(471,69)(471,54)(255,54)(255,104)])
  link(onEvent2,145:doEvent,[])
}
Add(IndexToChannel,145,504,70)
{
  link(onEvent2,143:doPlay,[])
}
Add(MatrixEnum,302,448,168)
{
  link(onEnum,303:doCompare,[(492,174)(492,265)])
  link(Matrix,309:Var2,[])
}
Add(If_else,303,504,259)
{
  Type=1
  Op2=Integer(2)
  link(onTrue,305:doEvent1,[])
}
Add(Hub,305,560,259)
{
  link(onEvent1,25:doCalc,[(591,265)(591,314)])
  link(onEvent2,306:doCalc,[])
}
Add(MathParse,306,609,266)
{
  MathStr=#29:point($pos[0]*16, $pos[1]*16)|
  Args=#3:pos|
  link(onResult,23:doDraw,[])
  link(pos,302:Index,[(615,247)(461,247)])
}
Add(GetDataEx,309,448,142)
{
  link(Data,97:Array,[])
}
Add(Hub,444,343,91)
{
  link(onEvent1,97:doClear,[])
  link(onEvent2,98:doClear,[])
}
Add(Button,133,133,91)
{
  Left=105
  Top=14
  Width=#3:143|
  Height=#2:28|
  Caption=#5:Start|
  link(onClick,134:doEvent1,[])
}
Add(MultiElementEx,495,126,203)
{
  @Comment=#10:Setup bomb|
  AddHint(-98,-40,0,0,@Comment)
  link(Matrix,66:Var1,[(132,140)])
}
BEGIN_SDK
Add(MultiElementEditorEx,494,7,7)
{
  WorkCount=#7:doSetup|
  DataCount=#6:Matrix|
  @VOffset=84
  @HOffset=126
  link(doSetup,496:doFor,[])
}
Add(For,496,63,91)
{
  link(onEvent,497:doCalc,[])
  link(End,498:Value,[])
}
Add(MathParse,497,133,91)
{
  MathStr=#50:$matr[round(random()*19)][round(random()*19)] = -1|
  DataCount=0
  Args=#4:matr|
  link(matr,494:Matrix,[])
}
Add(Memory,498,63,35)
{
  Default=Integer(35)
  @Comment=#15:Number of bombs|
}
END_SDK
Add(MultiElementEx,501,161,259)
{
  @Comment=#24:Calc bombs in near cells|
  AddHint(59,6,0,0,@Comment)
  link(Matrix,109:Var2,[])
}
BEGIN_SDK
Add(MultiElementEditorEx,500,7,7)
{
  WorkCount=#6:doCalk|
  DataCount=#6:Matrix|
  @VOffset=77
  @HOffset=112
  @Width=475
  link(doCalk,511:doEnum,[])
}
Add(For,502,189,84)
{
  End=8
  link(onEvent,504:doCalc,[])
  link(onStop,507:doCalc,[(237,97)(237,167)])
}
Add(Array,503,252,28)
{
  Array=#20:[-1,-1,-1,0,1,1,1,0]|
}
Add(MathParse,504,252,84)
{
  MathStr=#58:[$pos[0] + $arr[$index], $pos[1] + $arr[($index + 2) % 8]]|
  Args=#3:arr|5:index|3:pos|
  link(onResult,510:doRead,[])
  link(arr,503:Array,[])
  link(pos,512:Var2,[(272,70)(153,70)])
}
Add(If_else,505,364,84)
{
  Op2=Integer(-1)
  link(onTrue,513:doNext,[])
}
Add(If_else,506,77,84)
{
  Op2=Integer(0)
  link(onTrue,508:doData,[])
}
Add(MathParse,507,252,161)
{
  MathStr=#29:$m[$pos[1]][$pos[0]] = $value|
  Args=#1:m|3:pos|5:value|
  link(onResult,513:doReset,[(408,167)(408,97)])
  link(m,509:Var2,[(258,144)(125,144)])
  link(pos,512:Var3,[(265,133)])
  link(value,513:Value,[(272,139)(426,139)])
}
Add(DoData,508,140,84)
{
  Data=Integer(0)
  link(onEventData,502:doFor,[])
}
Add(GetDataEx,509,119,49)
{
  link(Data,500:Matrix,[])
}
Add(MatrixRead,510,308,84)
{
  link(onRead,505:doCompare,[])
  link(Matrix,509:Var3,[(314,56)])
}
Add(MatrixEnum,511,28,84)
{
  link(onEnum,506:doCompare,[])
  link(Matrix,509:Var1,[(34,56)])
}
Add(GetDataEx,512,147,126)
{
  Angle=3
  link(Data,511:Index,[(41,133)])
}
Add(Counter,513,420,84)
{
}
END_SDK
Add(MultiElementEx,515,196,301)
{
  @Comment=#10:Draw cells|
  AddHint(50,4,0,0,@Comment)
  link(Matrix,109:Var3,[(202,245)])
  link(Image,108:Var2,[])
}
BEGIN_SDK
Add(MultiElementEditorEx,514,7,7)
{
  WorkCount=#6:doDraw|
  DataCount=#6:Matrix|5:Image|
  @VOffset=42
  @HOffset=77
  link(doDraw,516:doValue,[])
}
Add(Memory,516,28,49)
{
  link(onData,521:doEnum,[])
}
Add(MathParse,517,189,49)
{
  MathStr=#14:($arr[0]+1)*16|
  DataCount=1
  Args=#3:arr|
  link(onResult,518:doSourceX,[(237,55)(237,118)])
}
Add(DrawImageRegion,518,252,105)
{
  SourceY=16
  SourceWidth=16
  SourceHeight=16
  Point(doSourceX)
  link(Canvas,516:Value,[(258,93)(34,93)])
  link(Image,514:Image,[(272,37)(97,37)])
}
Add(MathParse,519,189,105)
{
  MathStr=#29:point($arr[1]*16, $arr[2]*16)|
  Args=#3:arr|
  link(onResult,518:doDraw,[])
}
Add(Hub,520,140,49)
{
  link(onEvent1,517:doCalc,[])
  link(onEvent2,519:doCalc,[(171,62)(171,111)])
}
Add(MatrixEnum,521,84,49)
{
  Data=1
  link(onEnum,520:doEvent1,[])
  link(Matrix,514:Matrix,[])
}
END_SDK
Add(MultiElementEx,537,371,175)
{
  @Comment=#9:Open cell|
  AddHint(-14,63,0,0,@Comment)
  link(TopMatrix,309:Var1,[(377,149)])
  link(BottomMatrix,107:Var2,[])
  link(onDraw,140:doWork1,[(417,181)(417,165)(298,165)])
  link(onGameEnd,144:doEvent1,[(426,188)(426,69)])
}
BEGIN_SDK
Add(MultiElementEditorEx,536,7,7)
{
  WorkCount=#6:doOpen|
  EventCount=#6:onDraw|9:onGameEnd|
  DataCount=#9:TopMatrix|12:BottomMatrix|
  @VOffset=63
  @HOffset=518
  @Width=832
  @Height=277
  link(doOpen,558:doEvent1,[])
}
Add(MathParse,538,98,70)
{
  MathStr=#42:[floor($mouse[0]/16), floor($mouse[1]/16)]|
  Args=#5:mouse|
  AddHint(-72,-36,0,0,MathStr)
}
Add(Stack,539,189,126)
{
  link(onPop,552:doEvent1,[])
}
Add(Hub,540,119,126)
{
  OutCount=3
  link(onEvent1,551:doWork2,[])
  link(onEvent2,553:doWork2,[])
  link(onEvent3,561:doWork2,[(146,146)(146,27)])
}
Add(If_else,541,392,133)
{
  Type=1
  Op2=Integer(2)
  link(onTrue,543:doCalc,[])
}
Add(Memory,542,266,133)
{
  link(onData,567:doRead,[])
}
Add(MathParse,543,476,133)
{
  MathStr=#20:%1[%2[1]][%2[0]] = 2|
  AddHint(-42,45,0,0,MathStr)
  link(onResult,568:doRead,[])
  link(X1,569:Var2,[])
  link(X2,544:Var2,[])
}
Add(GetDataEx,544,483,112)
{
  Angle=3
  link(Data,542:Value,[(379,119)(379,179)(272,179)])
}
Add(If_else,545,588,133)
{
  Op2=Integer(0)
  link(onTrue,546:doData,[])
  link(onFalse,554:doCompare,[(632,146)(632,195)])
}
Add(DoData,546,644,133)
{
  link(onEventData,547:doFor,[])
}
Add(For,547,700,133)
{
  End=8
  link(onEvent,549:doCalc,[])
}
Add(Array,548,756,77)
{
  Array=#20:[-1,-1,-1,0,1,1,1,0]|
}
Add(MathParse,549,756,133)
{
  MathStr=#42:[%2[0] + %1[%3], %2[1] + %1[(%3 + 2) % 8]]|
  DataCount=3
  Args=#2:X1|2:X2|2:X3|
  AddHint(-175,98,0,0,MathStr)
  link(onResult,551:doWork1,[(800,139)(800,61)(158,61)])
  link(X1,548:Array,[])
  link(X2,550:Var3,[(769,119)])
}
Add(GetDataEx,550,539,112)
{
  Angle=3
  link(Data,544:Var3,[(545,119)])
}
Add(HubEx,551,154,126)
{
  link(onEvent,539:doPush,[])
}
Add(Hub,552,231,133)
{
  link(onEvent1,542:doValue,[])
  link(onEvent2,553:doWork3,[(255,146)(255,164)(158,164)])
}
Add(HubEx,553,154,133)
{
  link(onEvent,539:doPop,[])
}
Add(If_else,554,644,189)
{
  Op2=Integer(-1)
  link(onTrue,565:doWork2,[])
}
Add(ArrayRead,555,112,224)
{
  Index=2
  link(onRead,556:doCompare,[])
}
Add(If_else,556,161,224)
{
  Op2=Integer(0)
  link(onTrue,559:doData,[(207,230)(207,185)(52,185)(52,132)])
  link(onFalse,557:doCalc,[])
}
Add(MathParse,557,224,231)
{
  MathStr=#47:$M[$pos[1]][$pos[0]] = 1 - $M[$pos[1]][$pos[0]]|
  Args=#3:pos|1:M|
  AddHint(50,21,0,0,MathStr)
  link(onResult,561:doWork3,[(445,237)])
  link(pos,560:Var2,[(230,173)(104,173)])
  link(M,563:Var1,[(237,70)])
}
Add(Hub,558,63,70)
{
  link(onEvent1,538:doCalc,[])
  link(onEvent2,555:doRead,[(86,83)(86,230)])
}
Add(DoData,559,63,126)
{
  link(onEventData,540:doEvent1,[])
  link(Data,560:Var1,[(69,112)])
}
Add(GetDataEx,560,98,105)
{
  link(Data,538:Result,[])
}
Add(HubEx,561,441,21)
{
  link(onEvent,562:doEvent1,[])
}
Add(Hub,562,546,21)
{
  link(onEvent1,536:onDraw,[(810,27)(810,76)])
  link(onEvent2,571:doCheck,[(574,34)(574,90)])
}
Add(GetDataEx,563,322,63)
{
  Angle=1
  link(Data,569:Var1,[])
}
Add(GetDataEx,564,532,42)
{
  link(Data,536:BottomMatrix,[])
}
Add(ChannelToIndex,565,700,182)
{
  link(onIndex,536:onGameEnd,[(809,188)(809,83)])
}
Add(GetDataEx,566,525,63)
{
  link(Data,536:TopMatrix,[])
}
Add(MatrixRead,567,322,133)
{
  link(onRead,541:doCompare,[])
  link(Matrix,563:Var2,[])
}
Add(MatrixRead,568,532,133)
{
  link(onRead,545:doCompare,[])
  link(Matrix,564:Var2,[])
  link(Index,550:Var2,[])
}
Add(GetDataEx,569,476,63)
{
  Angle=1
  link(Data,566:Var1,[])
}
Add(MultiElementEx,571,588,84)
{
  @Comment=#14:Check game end|
  link(onGameEnd,565:doWork1,[(688,90)(688,188)])
  link(TopMatrix,566:Var3,[(594,70)])
  link(BottomMatrix,564:Var3,[(601,49)])
}
BEGIN_SDK
Add(MultiElementEditorEx,572,7,7)
{
  WorkCount=#7:doCheck|
  EventCount=#9:onGameEnd|
  DataCount=#9:TopMatrix|12:BottomMatrix|
  @VOffset=49
  @HOffset=28
  @Width=377
  @Height=214
  link(doCheck,581:doEnum,[])
}
Add(If_else,573,112,56)
{
  Op2=Integer(1)
  link(onTrue,584:doRead,[])
  link(onFalse,576:doCompare,[(156,69)(156,111)])
}
Add(MathParse,574,294,56)
{
  MathStr=#6:%0 + 1|
  DataCount=0
  Args=#0:|
  AddHint(-8,-33,0,0,MathStr)
}
Add(If_else,575,224,56)
{
  Op2=Integer(-1)
  link(onTrue,577:doWork2,[])
}
Add(If_else,576,224,105)
{
  Op2=Integer(2)
  link(onTrue,577:doWork3,[(270,111)])
}
Add(HubEx,577,266,56)
{
  link(onEvent,574:doCalc,[])
}
Add(MathParse,578,147,147)
{
  MathStr=#9:$len*$len|
  DataCount=1
  Args=#3:len|
  AddHint(-20,48,0,0,MathStr)
  link(onResult,580:doEvent1,[])
}
Add(If_else,579,294,147)
{
  link(onTrue,572:onGameEnd,[(355,153)(355,62)])
  link(Op1,574:Result,[])
}
Add(Hub,580,245,147)
{
  link(onEvent1,579:doCompare,[])
  link(onEvent2,574:doClear,[(280,160)(280,69)])
}
Add(MatrixEnum,581,35,56)
{
  link(onEnum,573:doCompare,[])
  link(onEnd,582:doSize,[(80,69)(80,153)])
  link(Matrix,583:Var2,[])
}
Add(ArraySize,582,91,147)
{
  link(onSize,578:doCalc,[])
  link(Array,583:Var3,[(97,42)])
}
Add(GetDataEx,583,35,35)
{
  link(Data,572:TopMatrix,[])
}
Add(MatrixRead,584,168,56)
{
  link(onRead,575:doCompare,[])
  link(Matrix,572:BottomMatrix,[(174,32)(48,32)])
  link(Index,581:Index,[(181,42)(208,42)(208,99)(48,99)])
}
END_SDK
END_SDK
